<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>NFToshi Explorer</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="style.css" rel="stylesheet" type="text/css" />

  <!-- Helpers and datasets -->
  <script src="/helpers.js"></script>
  <script src="/data/rank_by_rarity.js"></script>

  <!-- Frame setup -->
  <meta property="og:title" content="NFToshi Explorer"" />
  <meta property='og:image' content="
    https://cloudflare-ipfs.com/ipfs/bafybeicgkb56vydl3kkcrgox7dpyatrgafxogurp42opjmiocfnwmbftlm/0.png"" />
  <meta property="fc:frame" content="vNext" />

  <!-- Parse query parameters to handle interactivity -->
  <script>
    const queryParams = new URLSearchParams(window.location.search);
    const page = queryParams.get("page");
    if (page == "random") {
      let token_id = Math.floor(Math.random() * 3001);
      addImage(imgUrl(token_id));
      addButton(1, "One more", "post", "/index.html?page=random");
      addButton(2, "Marketplace", "link", marketplaceUrl(token_id));
      addButton(3, "Home", "post", "/index.html?page=main");

    } else if (page == "traits") {
      const trait = queryParams.get("trait") ? queryParams.get("trait") : "bg";
    } else if (page == "rarity") {
      const idx = queryParams.get("idx") ? queryParams.get("idx") : 1;
      let token_id = rankByRarity[parseInt(idx)];
      addImage(imgUrl(token_id));
      addButton(1, "Next", "post", "/index.html?page=rarity&idx=" + (parseInt(idx) + 1));
      addButton(2, "Marketplace", "link", marketplaceUrl(token_id));
      addButton(3, "Home", "post", "/index.html?page=main");

    } else {
      // Main page
      addImage(imgUrl(0));
      addButton(1, "Random", "post", "/index.html?page=random");
      //addButton(3, "By trait", "post", "/index.html?page=traits");
      addButton(2, "By rarity", "post", "/index.html?page=rarity");
    }
  </script>
</head>

<body>
  <div class="container text-center">
    <h1 class="display-1">NFToshi Explorer</h1>
    <p>A Farcaster frame for exploring the NFToshi collection. Cast the URL to this page to use it!</p>
    <p>Make sure to also check out the <a href="https://www.toshithecat.com/nftoshis">official collection homepage</a>.
    </p>
    <p>Made by <a href="https://ethspresso-linktree.replit.app/">Ethspresso</a>.</p>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  </div>
</body>

</html>